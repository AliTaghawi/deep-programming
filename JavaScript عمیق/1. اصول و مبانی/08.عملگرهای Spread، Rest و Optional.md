# عملگرهای Spread، Rest و Optional Chaining در JavaScript

---

## معرفی کلی

JavaScript با معرفی ES6 و ES2020 سه عملگر جدید ارائه داد که خوانایی و انعطاف کد را به‌شدت افزایش می‌دهند:  
- Spread (`...`)  
- Rest (`...`)  
- Optional Chaining (`?.`)  

هر یک از این عملگرها در موقعیت‌های متفاوتِ نگارشی معنا و کاربرد خاصی دارند و با وجود شباهت ظاهری، نقش متمایزی ایفا می‌کنند.

---

## عملگر Spread (`...`)

عملگر Spread موارد یک آرایه یا ویژگی‌های یک شیء را «تکثیر» و به‌صورت جداگانه در یک ساختار جدید جای‌گذاری می‌کند.

### کاربردها

- ترکیب آرایه‌ها  
- عبور آرایه به‌عنوان آرگومان تابع  
- کپی سطحی (shallow copy) آرایه و شیء  
- ترکیب و گسترش ویژگی‌های شیء  

### مثال‌ها

```js
// ترکیب آرایه‌ها
const arr1 = [1, 2];
const arr2 = [3, 4];
const combined = [...arr1, ...arr2]; // [1, 2, 3, 4]

// عبور آرایه به‌عنوان آرگومان
function sum(x, y, z) {
  return x + y + z;
}
const nums = [1, 2, 3];
sum(...nums); // 6

// کپی سطحی شیء
const obj1 = { a: 1, b: 2 };
const obj2 = { ...obj1, c: 3 }; // { a:1, b:2, c:3 }
```

### نکات مهم

- Spread کپی **سطحی** می‌سازد؛ برای آرایه‌های تو در تو یا اشیاء تو در تو باید از کلون عمیق استفاده کنید.  
- ترتیب Spread اهمیت دارد: ویژگی‌های بعدی می‌توانند ویژگی‌های قبلی را بازنویسی کنند.  
- در React و JSX برای گسترش props بسیار کاربرد دارد:  
  ```jsx
  <Component {...props} extra="value" />
  ```

---

## عملگر Rest (`...`)

در مقابل Spread، عملگر Rest با نگه‌داشت تعداد نامشخصی از مقادیر «باقی‌مانده» را در یک متغیر جمع می‌کند.

### کاربردها

- پارامترهای تابع با تعداد متغیر  
- استخراج مقادیر باقی‌مانده در Destructuring آرایه و شیء  

### مثال‌ها

```js
// در تعریف تابع
function multiply(factor, ...nums) {
  return nums.map(n => n * factor);
}
multiply(2, 1, 2, 3); // [2, 4, 6]

// Destructuring آرایه
const [first, ...restArray] = [10, 20, 30, 40];
// first = 10, restArray = [20, 30, 40]

// Destructuring شیء
const { a, b, ...restObj } = { a: 1, b: 2, c: 3, d: 4 };
// restObj = { c:3, d:4 }
```

### نکات مهم

- Rest تنها در موقعیت آخر پارامترها یا آخر ساختار Destructuring مجاز است.  
- با Rest می‌توان آرگومان‌های تابع را جایگزین `arguments` کرد تا با آن کارکرد مشابه و خواناتر داشته باشید.  

---

## عملگر Optional Chaining (`?.`)

Optional Chaining از بروز خطای TypeError هنگام دسترسی به خصوصیت‌های `null` یا `undefined` جلوگیری می‌کند.

### کاربردها و نحو

- دسترسی ایمن به خصوصیت‌ها  
- فراخوانی ایمن متدها  
- ایندکس‌گذاری ایمن روی آرایه  

```js
const user = { profile: { name: "Sara" } };

// دسترسی به نام با چک خودکار nullish
const name = user.profile?.name;        // "Sara"
const age  = user.profile?.age;         // undefined (به‌جای خطا)

// فراخوانی ایمن متد
user.getData?.();                       // اگر getData وجود نداشته باشد، undefined

// ایندکس‌گذاری ایمن
const firstItem = user.items?.[0];      // undefined اگر items تعریف نشده باشد
```

### رفتار و محدودیت‌ها

- هر جا که `?.` ببیند، اگر سمت چپ آن `null` یا `undefined` باشد، کل عبارت بلافاصله `undefined` برمی‌گردد.  
- نمی‌توان از Optional Chaining در سمت چپ انتساب استفاده کرد:  
  ```js
  obj?.prop = 5;   // خطا
  ```
- اگر پس از `?.` تابعی قرار گیرد (مثلاً `obj.method?.()`)، در صورت نبودن متد، فراخوانی انجام نمی‌شود.

---

## جدول مقایسه Spread، Rest و Optional Chaining

| عملگر          | نحو                         | کاربرد اصلی                                       |
|---------------|-----------------------------|---------------------------------------------------|
| Spread        | `...iterable`<br>`{ ...obj }` | تکثیر عناصر آرایه یا ویژگی‌های شیء در ساختار جدید |
| Rest          | `...rest` در پارامتر تابع<br>`[a, ...rest]`<br>`{ a, ...rest }` | جمع‌بندی مقادیر یا ویژگی‌های باقی‌مانده           |
| Optional Chain| `obj?.prop`<br>`fn?.()`<br>`arr?.[i]` | دسترسی امن به خصوصیت‌ها، متدها و ایندکس‌ها        |

---

## اولویت و ترتیب ارزیابی

- Destructuring (Rest) قبل از تخصیص اجرا می‌شود.  
- Spread در محل آرایه یا شیء گسترش می‌یابد قبل از ارزیابی بقیه عبارت.  
- Optional Chaining در زمان ارزیابی نقطه یا براکت بررسی می‌شود و می‌تواند کوتاه‌سازی کند.

---

## نکات و بهترین شیوه‌ها

- از Spread برای کپی سریع و ترکیب آرایه و شیء بهره ببرید، اما مراقب کپی سطحی باشید.  
- با Rest متغیرهای تابع خود را ایزوله و خواناتر تعریف کنید؛ از `arguments` کمتر استفاده کنید.  
- Optional Chaining حجم کد چک روی `null`/`undefined` را به‌شدت کاهش می‌دهد؛ ولی دقت کنید بیش از حد زنجیره‌سازی نکنید تا اشکال‌زدایی آسان بماند.  
- در کنار Optional Chaining از Nullish Coalescing (`??`) برای مقداردهی پیش‌فرض استفاده کنید:  
  ```js
  const title = post?.title ?? "بدون عنوان";
  ```

---

## بیشتر بدانید

- Nullish Coalescing (`??`) و تفاوت آن با `||`  
- Dynamic Import (`import()`) و Top-Level Await  
- الگوهای Immutable در React با Spread و Rest  
- پروپوزال Pipeline Operator (`|>`) و نقش آن در خوانایی کد  
- ساختارهای پراکسی (Proxy) و تأثیر Optional Chaining بر عملکرد آن‌ها
