# انواع تعریف متغیر در جاوااسکریپت: var، let و const

---

## معرفی کلی

جاوااسکریپت سه روش اصلی برای تعریف متغیر ارائه می‌دهد که از نظر دامنه (scope)، خاصیت hoisting و قواعد بازنشانی (reassignment) با یکدیگر تفاوت دارند. متغیرهایی که با var تعریف می‌شوند، رفتار متفاوتی نسبت به let و const دارند که با ورود ES6 معرفی شدند. دانستن تفاوت‌های این سه برای جلوگیری از خطاهای ناخواسته و نوشتن کد قابل پیش‌بینی حیاتی است.

---

## var

متغیرهای تعریف‌شده با var قواعد زیر را دارند:

- دامنه (Scope): تابع یا سطح جهانی  
- Hoisting: اعلامیه‌ها به بالای دامنه منتقل می‌شوند و مقدار اولیه‌شان undefined است  
- قواعد بازنشانی (Reassignment): مجاز  
- اعلامیه مجدد (Redeclaration): در یک دامنه مجاز است  
- اثر بر روی شیٔ‌ جهانی: در صورت تعریف در سطح جهانی، به‌عنوان ویژگی window ظاهر می‌شود  

مثال:
```js
console.log(a); // undefined
var a = 5;
console.log(a); // 5

function foo() {
  var b = 10;
}
```  


---

## let

let متغیرهای بلاکی را معرفی می‌کند و ویژگی‌های زیر را دارد:

- دامنه: بلاکی ({ ... })  
- Hoisting: اعلامیه به بالای بلاک منتقل اما مقداردهی نشده در Temporal Dead Zone (TDZ) قرار می‌گیرد  
- TDZ: دسترسی قبل از مقداردهی منجر به ReferenceError می‌شود  
- قواعد بازنشانی (Reassignment): مجاز  
- اعلامیه مجدد (Redeclaration): در یک بلاک غیرمجاز است  
- اثر بر روی شیٔ‌ global: در صورت تعریف در سطح جهانی، ویژگی window ایجاد نمی‌کند  

مثال:
```js
{
  console.log(x); // ReferenceError
  let x = 20;
}
```  


---

## const

const مشابه let است اما برای تعریف ثابت‌ها کاربرد دارد:

- دامنه: بلاکی  
- Hoisting: مانند let در TDZ قرار می‌گیرد  
- قواعد بازنشانی (Reassignment): غیرمجاز (binding ثابت است)  
- اعلامیه مجدد (Redeclaration): غیرمجاز  
- تغییر مقادیر مرجعی: اگر مقدار آرایه یا شیء باشد، ویژگی‌های داخلی قابل تغییرند  
- اثر بر روی شیٔ‌ global: ایجاد نمی‌کند  

مثال:
```js
const PI = 3.14;
PI = 3.1415; // TypeError

const obj = { a: 1 };
obj.a = 2;   // مجاز است
```  


---

## مقایسه اجمالی

| ویژگی               | var                      | let                               | const                            |
|:--------------------|:-------------------------|:----------------------------------|:---------------------------------|
| دامنه (Scope)       | تابع یا جهانی           | بلاکی                              | بلاکی                            |
| Hoisting            | اعلامیه و init=undefined | اعلامیه در TDZ بدون مقدار اولیه    | اعلامیه در TDZ بدون مقدار اولیه  |
| Temporal Dead Zone  | ندارد                   | دارد                               | دارد                             |
| Redeclaration       | مجاز                     | غیرمجاز                          | غیرمجاز                         |
| Reassignment        | مجاز                     | مجاز                               | غیرمجاز (binding ثابت)           |
| ویژگی global object | ایجاد می‌کند            | ایجاد نمی‌کند                     | ایجاد نمی‌کند                    |

---

## محیط نگارشی و اجرایی

در هر Execution Context، یک Lexical Environment نگهداری می‌شود که شامل دو بخش است:

- Environment Record: نگهدارنده متغیرهای let/const  
- VariableEnvironment: نگهدارنده متغیرهای var  

در زمان اجرا، موتور جاوااسکریپت ابتدا Lexical Environment را می‌سازد و بر اساس قواعد hoisting متغیرها را در ساختار مناسب ثبت می‌کند.

---

## منابع

1. ECMA-262 Language Specification, 2023 Edition, Section 8.1 and 8.3.  
2. MDN Web Docs: var.  
3. MDN Web Docs: let.  
4. MDN Web Docs: const.  
5. ECMA-262 Language Specification, Lexical Environments Section.  
