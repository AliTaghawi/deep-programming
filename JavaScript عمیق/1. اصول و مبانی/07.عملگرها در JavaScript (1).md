# عملگرها در JavaScript (1)

## مقدمه

عملگرها ابزارهایی هستند که روی مقادیر (operand) عمل می‌کنند و نتایج جدیدی می‌سازند یا وضعیت برنامه را تغییر می‌دهند.  
در JavaScript پنج دستهٔ اصلی وجود دارد: حسابی، انتساب، مقایسه، منطقی و بیتی.  
درک دقیق رفتار هر دسته شامل نحو، نکات پیرامون تبدیل نوع و اولویت ارزیابی، کلید نوشتن کد بهینه و بدون باگ است.

---

## 1. عملگرهای حسابی

عملگرهای حسابی برای انجام محاسبات عددی و رشته‌ای استفاده می‌شوند:

- جمع (`+`) رشته‌سازی یا جمع عددی  
- تفریق (`-`)، ضرب (`*`)، تقسیم (`/`)، باقی‌مانده (`%`)  
- توان (`**`) در ES2016  

تبدیل نوع در `+` باعث می‌شود اگر یکی از عملوندها رشته باشد، رشته‌سازی انجام شود.  

عملوندهای غیرعدد مانند `null` یا `true` ابتدا به عدد تبدیل و سپس محاسبه می‌شوند.

---

## 2. عملگرهای انتساب

عملگرهای انتساب مقدار را در متغیری ذخیره می‌کنند و شامل حالت ترکیبی (compound) نیز می‌شوند:

1. انتساب ساده (`=`)  
2. ترکیبی (`+=`, `-=`, `*=`, `/=`, `%=`, `**=`)  
3. انتساب شرطی در ES2021 (`||=`, `&&=`, `??=`)  

عملیات ترکیبی معادل ترکیب عملگر حسابی با انتساب ساده است.  

در انتساب شرطی، فقط وقتی سمت چپ falsy یا nullish باشد مقدار سمت راست نوشته می‌شود.

---

## 3. عملگرهای مقایسه

برای مقایسهٔ ارزش‌ها و تعیین رابطهٔ بین دو مقدار استفاده می‌شوند:

- مساوی یا نه (`==`, `===`, `!=`, `!==`)  
- بزرگ‌تر، کوچک‌تر (`>`, `<`, `>=`, `<=`)  
- در شامل (`in`) و instanceof  

`===` همیشه بدون تبدیل نوع مقایسه می‌کند و رفتار قابل پیش‌بینی‌تری دارد.  

`in` بررسی می‌کند کلید در شیء موجود است و `instanceof` بررسی می‌کند شیء از یک تابع سازنده ارث برده باشد.

---

## 4. عملگرهای منطقی

سه عملگر اصلی برای کنترل جریانات شرطی بر پایهٔ truthy/falsy:

- AND (`&&`)، OR (`||`)، NOT (`!`)  

هر کدام Short-circuit evaluation دارند و ممکن است عملوند دوم را نادیده بگیرند.  

از ES2020 عملگر Nullish Coalescing (`??`) معرفی شد که فقط در برابر `null` یا `undefined` کوتاه‌سازی می‌کند.

---

## 5. عملگرهای بیتی

این عملگرها روی نمایش دودویی اعداد عمل می‌کنند و برای کارهای سطح پایین مفیدند:

- AND (`&`)، OR (`|`)، XOR (`^`), NOT (`~`)  
- شیفت چپ (`<<`)، شیفت راست با علامت (`>>`)، شیفت راست بدون علامت (`>>>`)  

اعداد ابتدا به ۳۲ بیت می‌روند و نتیجهٔ محاسبه دوباره به ۶۴ بیت تبدیل می‌شود.  

برای عملیات روی پرچم‌ها و ماسک‌ها، سرعت و دقت مناسبی ارائه می‌دهند.

---

## جدول دسته‌بندی عملگرها

| دسته          | نمادهای اصلی                                  | توضیح                                   |
|---------------|-----------------------------------------------|-----------------------------------------|
| حسابی         | +, -, *, /, %, **                             | محاسبات عددی و رشته‌ای                   |
| انتساب        | =, +=, -=, *=, /=, %=, ||=, &&=, ??=         | ذخیرهٔ مقدار و ترکیب با عملیات قبلی     |
| مقایسه        | ==, ===, !=, !==, >, <, >=, <=, in, instanceof | تعیین روابط و تطابق نوع/مقدار            |
| منطقی         | &&, \|\|, !, ??                               | کنترل جریان بر اساس truthy/falsy       |
| بیتی          | &, \|, ^, ~, <<, >>, >>>                      | عملیات روی بیت‌های نمایش دودویی         |

---

## اولویت و ترکیب

الویت عملگرها تعیین می‌کند کدام بخش از عبارت اول ارزیابی شود.  
مثلاً `*` و `/` بالاتر از `+` و `-` قرار دارند و `&&` پایین‌تر از تمامی عملگرهای حسابی و مقایسه است.  
برای اطمینان از ترتیب دلخواه، همیشه از پرانتز استفاده کنید.

---

## نکات و بهترین شیوه‌ها

- به‌جای `==` همیشه از `===` بهره ببرید تا از تبدیل نوع ناخواسته جلوگیری کنید.  
- در ترکیب عملگرهای بیتی و عددی، مطمئن شوید مقادیر ورودی عدد صحیح ۳۲ بیتی هستند.  
- از انتساب ترکیبی برای کوتاه‌کردن و خوانایی بهتر استفاده نمایید.  
- Short-circuit در عملگرهای منطقی را برای ارزیابی امن پیش‌نیازها به کار گیرید.  
- جدول اولویت‌ها را در ذهن نگه دارید یا با پرانتز خوانایی را تضمین کنید.

---

## بیشتر بدانید

- عملگرهای یونری (`typeof`, `void`, `delete`) و کاربردهای آنها  
- اپراتور سه‌تایی (`condition ? expr1 : expr2`) برای شرط‌های ساده  
- پروکسی‌ها و دامپینگ عملیات با `Symbol.operator`  
- عملکرد عملگرها در WebAssembly و تفاوت سطح پایین  
- استراتژی‌های linting (ESLint) برای جلوگیری از اشتباهات رایج


-----------------//////////////کاملتر توضیح بده////////////////--------------------

# عملگرها در JavaScript – توضیح جامع

---

## مقدمه

در JavaScript مجموعه‌ای از عملگرها وجود دارد که هر کدام وظیفهٔ خاصی در تبدیل، مقایسه یا ترکیب داده‌ها دارند.  
درک کامل آنها کمک می‌کند از خطاهای رایج جلوگیری کرده و کد خواناتر، بهینه‌تر و قابل نگهداری‌تری بنویسیم.

---

## 1. عملگرهای حسابی (Arithmetic Operators)

### انواع و کاربرد

- عملگرهای باینری  
  - جمع (`+`)، تفریق (`-`)، ضرب (`*`)، تقسیم (`/`)، باقی‌مانده (`%`)، توان (`**`)  
- عملگرهای یونی  
  - مثبت (`+x`)، منفی (`-x`)، افزایش‌دهنده / کاهش‌دهندهٔ پیش‌وندی و پس‌وندی (`++x`, `x++`, `--x`, `x--`)  
- عملگر کاما  
  - `(expr1, expr2)` فقط مقدار آخر را برمی‌گرداند

### جزئیات تبدیل نوع

- `+`  
  - اگر یکی از عملوندها رشته باشد، رشته‌سازی می‌کند:  
    ```js
    1 + "2"    // "12"
    ```
  - در غیر این صورت عمل جمع عددی است:  
    ```js
    1 + true   // 2  (true → 1)
    ```
- `-`, `*`, `/`, `%`, `**`  
  - همه عملوندها به عدد تبدیل می‌شوند (`ToNumber`):  
    ```js
    "5" - "2"  // 3
    ```

### افزایش‌دهنده و کاهش‌دهنده

- پیش‌وند (`++x`) مقدار را افزایش می‌دهد و سپس برمی‌گرداند  
- پس‌وند (`x++`) مقدار را برمی‌گرداند و سپس افزایش می‌دهد  
  ```js
  let a = 5;
  console.log(a++); // 5
  console.log(a);   // 6
  ```

---

## 2. عملگرهای انتساب (Assignment Operators)

### انتساب ساده و ترکیبی

- انتساب ساده  
  ```js
  let x = 10;
  ```
- انتساب ترکیبی  
  ```js
  x += 5;   // معادل x = x + 5
  x **= 2;  // معادل x = x ** 2
  ```

### انتساب شرطی (Logical Assignment)

از ES2021 برای مقداردهی تنها در صورت `falsy` یا `nullish` بودن:

- `x ||= y` → اگر `x` falsy بود، برابر `y` شود  
- `x &&= y` → اگر `x` truthy بود، برابر `y` شود  
- `x ??= y` → اگر `x` nullish بود (`null` یا `undefined`)، برابر `y` شود  

### انتساب در Destructuring

- آرایه  
  ```js
  let [a, b = 2] = [1];  // a=1, b=2
  ```
- شیء  
  ```js
  let { x: y = 10 } = { x: 5 };  // y=5
  ```

---

## 3. عملگرهای مقایسه (Comparison Operators)

### تساوی و نابرابری

| عملگر   | توضیح                                                               |
|---------|---------------------------------------------------------------------|
| `==`    | مقایسه با تبدیل نوع (Coercion)                                      |
| `===`   | مقایسهٔ دقیق نوع و مقدار (Strict Equality)                         |
| `!=`    | نابرابری با تبدیل نوع                                              |
| `!==`   | نابرابری دقیق                                                       |

- `==` می‌تواند نتایج غیرمنتظره بدهد:  
  ```js
  "" == 0       // true
  null == undefined  // true
  ```
- `===` امن‌تر و بدون تبدیل نوع است.

### مقایسه‌های مرتبه‌ای

- بزرگ‌تر (`>`), کوچک‌تر (`<`), بزرگ‌تر یا مساوی (`>=`), کوچک‌تر یا مساوی (`<=`)  
- مقایسهٔ رشته‌ها بر اساس کدهای یونیکد انجام می‌شود:  
  ```js
  "2" > "10"    // true  (چون '2' > '1')
  ```

### عملگرهای in و instanceof

- `prop in obj`  
  - بررسی می‌کند کلید `prop` در شیء یا پروتوتایپ‌های آن وجود دارد  
- `obj instanceof Constructor`  
  - بررسی می‌کند شیء از زنجیرهٔ پروتوتایپ تابع سازنده بهره می‌برد  

---

## 4. عملگرهای منطقی (Logical Operators)

### اصول کلی

- `&&` (AND)  
- `||` (OR)  
- `!` (NOT)  

تمام این عملگرها **Short-circuit** دارند:

- در `a && b` اگر `a` falsy باشد، دیگر `b` را ارزیابی نمی‌کند و همان `a` را برمی‌گرداند.  
- در `a || b` اگر `a` truthy باشد، `b` را نادیده گرفته و `a` را برمی‌گرداند.  

### مقادیر بازگشتی

این عملگرها الزماً `boolean` برنمی‌گردانند؛ بلکه آخرین مقدار ارزیابی‌شده را برمی‌گردانند:

```js
0 || "fallback"     // "fallback"
"hello" && 0        // 0
```

### Nullish Coalescing

- `a ?? b`  
  - اگر `a` برابر `null` یا `undefined` باشد، `b` بازمی‌گردد  
  - در مقابل `||` فقط برای تمام falsyها کوتاه‌سازی می‌کند  

---

## 5. عملگرهای بیتی (Bitwise Operators)

### تبدیل به 32 بیت

قبل از عملیات، عدد به یک مقدار ۳۲ بیتی (Signed Int32) تبدیل و پس از محاسبه دوباره به ۶۴ بیتی (Double) تبدیل می‌شود.

### فهرست عملگرها

| نماد   | توضیح                             |
|--------|-----------------------------------|
| `&`    | AND                               |
| `|`    | OR                                |
| `^`    | XOR                               |
| `~`    | NOT (تزویج)                       |
| `<<`   | شیفت چپ                           |
| `>>`   | شیفت راست با حفظ علامت           |
| `>>>`  | شیفت راست بدون حفظ علامت (Unsigned) |

### مثال‌ها

```js
5 & 1      // 1    (0101 & 0001 → 0001)
~5         // -6   (تزویج تمام بیت‌ها)
1 << 2     // 4    (0001 << 2 → 0100)
-1 >>> 1   // 2147483647  (علامت بیت از دست می‌رود)
```

---

## اولویت و پیوند عملگرها (Operator Precedence & Associativity)

برای درک نحوهٔ ارزیابی عبارات پیچیده جدول زیر کمک می‌کند:

| اولویت | عملگرها                                       | پیوند      |
|--------|-----------------------------------------------|------------|
| 20     | `()`                                          | —          |
| 17     | `++`, `--`, `+x`, `-x`, `~`, `!`              | راست به چپ |
| 15     | `**`                                          | راست به چپ |
| 14     | `*`, `/`, `%`                                 | چپ به راست |
| 13     | `+`, `-`                                      | چپ به راست |
| 12     | `<<`, `>>`, `>>>`                             | چپ به راست |
| 11     | `<`, `<=`, `>`, `>=`, `in`, `instanceof`      | چپ به راست |
| 10     | `==`, `!=`, `===`, `!==`                      | چپ به راست |
| 9      | `&`                                           | چپ به راست |
| 8      | `^`                                           | چپ به راست |
| 7      | `|`                                           | چپ به راست |
| 6      | `&&`                                          | چپ به راست |
| 5      | `||`, `??`                                    | چپ به راست |
| 4      | `?:` (ternary)                                | راست به چپ |
| 3      | `=`, `+=`, `-=`, ...                         | راست به چپ |
| 2      | `,`                                           | چپ به راست |

برای اطمینان از ترتیب دلخواه همیشه از پرانتز استفاده کنید.

---

## نکات و راهکارها

- تا حد امکان از `===` و `!==` استفاده کنید تا از تبدیل نوع ناخواسته جلوگیری شود.  
- هنگام کار با رشته و عدد، تبدیل نوع صریح (`Number()`, `String()`) خواناتر و امن‌تر است.  
- در انتساب ترکیبی، توجه کنید که تغییر سمت چپ ممکن است دوباره ارزیابی شود.  
- از Short-circuit برای شرطی‌سازی سریع و بهینهٔ کد بهره ببرید.  
- در عملیات بیتی حتماً با اعداد صحیح ۳۲ بیتی کار کنید یا از BigInt استفاده کنید تا به نتایج غیرمنتظره برنخورید.  
- جدول اولویت عملگرها را همراه خود داشته یا با پرانتزها ترتیب را صریح کنید.

---

با تسلط بر این طیف گسترده از عملگرها و جزئیات هر دسته، می‌توانید کد JavaScript خود را هم صحیح‌تر و هم بهینه‌تر بنویسید.
