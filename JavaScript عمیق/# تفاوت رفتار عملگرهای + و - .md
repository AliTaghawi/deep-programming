# تفاوت رفتار عملگرهای + و - در JavaScript

در JavaScript عملگرهای جمع (`+`) و تفریق (`-`) با نوع داده‌های متفاوت رفتارهای متمایزی دارند. این اختلاف به قواعد تبدیل نوع (type coercion) در زبان برمی‌گردد و باعث می‌شود نتیجه‌ی `"5" - 3‌‌‌‌` برابر عدد و نتیجه‌ی `"5" + 3"` یک رشته شود.

---

## قواعد تبدیل نوع برای تفریق (-)

- عملگر منفی تنها حالت عددی دارد.  
- ابتدا هر دو عملوند با قاعده‌ی ToNumber به عدد تبدیل می‌شوند.  
- بنابراین `"5"` به عدد `5` تبدیل شده و `5 - 3` برابر `2` خواهد بود.  

```js
console.log("5" - 3);  // 2
```

---

## قواعد تبدیل نوع برای جمع (+)

- عملگر جمع هم برای رشته و هم برای عدد کاربرد دارد و اولویت با رشته است.  
- اگر یکی از عملوندها رشته باشد، JavaScript ابتدا ToPrimitive و سپس ToString را فراخوانی می‌کند.  
- در نتیجه `"5" + 3` به رشته‌ی `"5"` و رشته‌ی `"3"` تبدیل شده و روی هم قرار می‌گیرند: `"53"`.  

```js
console.log("5" + 3);  // "53"
```

---

## جمع‌بندی مقایسه

| ویژگی                        | عملگر -               | عملگر +                |
|-------------------------------|-----------------------|------------------------|
| تبدیل نوع پیش‌فرض            | ToNumber              | ToString اگر رشته هست |
| نتیجه مثال `"5" - 3`         | عدد 2                 | —                      |
| نتیجه مثال `"5" + 3`         | —                     | رشته "53"              |

---

## راهکارهای جلوگیری از ابهام

- تبدیل صریح به عدد پیش از جمع:  
  ```js
  console.log(Number("5") + 3);  // 8
  ```
- استفاده از parsing مانند `parseInt` یا `parseFloat` پیش از عملیات جمع  
- در صورت نیاز به ترکیب رشته و عدد، اول همه را به رشته تبدیل کنید:  
  ```js
  console.log(String(5) + String(3));  // "53"
  ```

---

برای درک عمیق‌تر می‌توانید به مبحث Abstract Operations در مشخصات ECMAScript مراجعه کنید و ببینید که ToNumber و ToPrimitive چگونه رفتار می‌کنند. همچنین مطالعه‌ی عملیات ضرب (`*`) و تقسیم (`/`) نشان می‌دهد این عملگرها مشابه منطق منفی همواره عددی عمل می‌کنند و رشته‌ها را به عدد تبدیل می‌کنند.



-------------////////////////////////////
# مفهوم عملیات انتزاعی (Abstract Operations) در ECMAScript

عملیات انتزاعی توصیف‌های گام‌به‌گام و عمومی هستند که در مشخصات ECMAScript برای تبدیل و بررسی انواع داده‌ها تعریف شده‌اند. این توصیف‌ها نه متدهای قابل دسترس در کد، بلکه الگوریتم‌های درونی زبان هستند.

---

## انواع عملیات انتزاعی اصلی

- ToPrimitive  
- ToBoolean  
- ToNumber  
- ToString  
- ToObject  

---

## ToPrimitive

عملکرد: تبدیل یک مقدار غیر اولیه (مثلاً شیء یا آرایه) به مقدار اولیه (Primitive)  
الگوریتم کلی:

- اگر ورودی از نوع Primitive باشد، همان را برگردان.  
- اگر hint برابر string باشد، متدهای toString و سپس valueOf را صدا بزن.  
- اگر hint برابر number باشد، متدهای valueOf و سپس toString را صدا بزن.  
- اگر خروجی هنوز شیء بود، خطا پرتاب کن.

---

## ToBoolean

عملکرد: ارزیابی حقیقت‌‌نمای (truthiness) یک مقدار  
قوانین:

- مقادیر false, 0, NaN, '' (رشته خالی), null, undefined به false تبدیل می‌شوند.  
- بقیه مقادیر (از جمله اشیاء، آرایه‌ها و رشته‌های غیرخالی) به true تبدیل می‌شوند.

---

## ToNumber

عملکرد: تبدیل انواع به عدد  
گام‌های اصلی:

- boolean: true → 1, false → 0  
- null → 0, undefined → NaN  
- رشته: مطابق قواعد عددخوانی رشته parse می‌شود  
- شیء: ابتدا ToPrimitive با hint number و سپس به عدد تبدیل می‌شود

---

## ToString

عملکرد: تبدیل انواع به رشته  
قواعد تبدیل:

- undefined → "undefined", null → "null"  
- boolean → "true" یا "false"  
- عدد → نمایش رشته‌ای عدد (شامل نمای علمی برای اعداد بزرگ)  
- شیء → ابتدا ToPrimitive با hint string و سپس به رشته تبدیل می‌شود

---

## ToObject

عملکرد: تولید یک شیء براساس مقدار اولیه  
قواعد:

- null و undefined باعث خطای TypeError می‌شوند  
- رشته، عدد و boolean به اشیاء Wrapper تبدیل می‌شوند  
- اشیاء اصلی (object, array, function) بدون تغییر برگردانده می‌شوند

---

## جدول مروری عملیات

| عملیات        | ورودی                      | خروجی                                      |
|---------------|----------------------------|---------------------------------------------|
| ToPrimitive   | هر نوع                     | Primitive (string یا number بسته به hint)   |
| ToBoolean     | هر نوع                     | Boolean                                     |
| ToNumber      | هر نوع                     | Number                                      |
| ToString      | هر نوع                     | String                                      |
| ToObject      | هر نوع                     | Object (یا خطا برای null/undefined)         |

---

برای درک عمیق‌تر می‌توانید به فصل مربوط به Abstract Operations در مشخصات ECMAScript مراجعه کنید. آیا دوست داری مثال‌های عملی این تبدیل‌ها را در کد ببینی یا به جزئیات بیشتری مثل ToLength و ToPropertyKey بپردازیم؟
